<span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">This example is a basic reference application for GUI-like applications. An application for the creation and edition of forms. in MFlow.<br><br><a href="/noscript/wiki/complexthings/generateform" title="" target="">Here is the application running</a>&nbsp;<br><br><a href="https://github.com/agocorona/MFlow/blob/master/Demos/GenerateForm.hs" title="" target="">And this is the complete current source code<br></a></span><br>This is a screenshoot<br><br><br><div style="text-align: center;"><img src="/formgen.png" alt="" align="none" style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"></div><div style="text-align: center;"><font face="rebuchet MS, Helvetica, Arial, Verdana, sans-serif"><br></font></div><h1><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">How it works</span></h1><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">MFlow is a web framework intended for high level web programming. It is possible to create multipage as well as complex single page applications with dinamic behaviours in pure haskell, without the need of Javascript programming</span><br style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><br style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">This application has a dynamic menu to add widgets to an WYSIWYG editor, so you can create a page fragment with text and form elements. You can arange the layout with the editor. Finally, yo can test the form created.</span><br style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><br style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">The example is intended to be a reference implementation for complex single page applications. It does not have some sophistications like multilevel undo, persistence, widget autorefresh , field validation messages etc that will be addded to other examples coming.<br><br><i>This text is intentionally terse. It does not matter if you don't understand it. The idea is that you must play with the code. Modify it. Later you may understand more and more the text</i>.<br><br>To run the application:<br></span><h4><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">&gt;runghc Demos/GenerateForm.hs&nbsp;</span></h4><br style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">The top level is this function that contain the navigation of the tree pages mentioned: creation of the form, form input and show results of the form:</span><br style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><pre style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;"><div class="line" id="LC37" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC37" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genForm</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC38" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">let</span> <span class="n" style="box-sizing: border-box;">title</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"form.html"</span></div><div class="line" id="LC39" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">initFormTemplate</span> <span class="n" style="box-sizing: border-box;">title</span></div><div class="line" id="LC40" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC41" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">desc</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span>  <span class="n" style="box-sizing: border-box;">page</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">createForm</span> <span class="n" style="box-sizing: border-box;">title</span></div><div class="line" id="LC42" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC43" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">r</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">page</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">b</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"This is the form created, asking for input"</span></div><div class="line" id="LC44" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">hr</span></div><div class="line" id="LC45" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">generateForm</span> <span class="n" style="box-sizing: border-box;">title</span> <span class="n" style="box-sizing: border-box;">desc</span></div><div class="line" id="LC46" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;++</span> <span class="n" style="box-sizing: border-box;">br</span></div><div class="line" id="LC47" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;**</span> <span class="n" style="box-sizing: border-box;">pageFlow</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"button"</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">submitButton</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"submit"</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC48" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC49" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">page</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span>  <span class="n" style="box-sizing: border-box;">h3</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"results of the form:"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="n" style="box-sizing: border-box;">show</span> <span class="n" style="box-sizing: border-box;">r</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">noWidget</span></div><div class="line" id="LC50" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">return</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 134, 179);">()</span></div><div class="line" id="LC51" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC51" style="text-align: justify; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The next thing is the definition of the form data structure that will be generated by the application. As you see, a form can contain other form fragments, but this will not be used in this application. The definition of the kinds of widgets that can be added can be made extensible too, but this is not the goal of this demo.</span><br style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><pre style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Courier, monospace; margin-top: 0px; margin-bottom: 0px;"></pre></div><div class="line" id="LC52" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;"><br></span></div><div class="line" id="LC52" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;">type</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Template</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span></div><div class="line" id="LC53" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;">data</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WType</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Intv</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Stringv</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">TextArea</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span><span class="p" style="box-sizing: border-box;">[</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC54" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="p" style="box-sizing: border-box;">[</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span><span class="p" style="box-sizing: border-box;">]</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Form</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Template</span> <span class="p" style="box-sizing: border-box;">[</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WType</span><span class="p" style="box-sizing: border-box;">]</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">deriving</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Typeable</span><span class="p" style="box-sizing: border-box;">,</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Read</span><span class="p" style="box-sizing: border-box;">,</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Show</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC55" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC55" style="box-sizing: border-box; padding-left: 10px; line-height: 18px; font-size: 12px; font-family: Consolas, 'Liberation Mono', Courier, monospace; color: rgb(51, 51, 51);"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">Then it comes the initialization. The generated form is defined by the structure above and the template. The latter is a html file that contains the layout edited by the user. Here below both components are initialized. &nbsp;The layout will be contained in an editable text field element. The former is stored in the a session variable. There is a sequence variable&nbsp;</span><span style="color: rgb(68, 85, 136); font-weight: bold;">Seq</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;that is used to assign sequential identifiers to the form fields. That variable is also initialized.</span></div><div class="line" id="LC55" style="box-sizing: border-box; padding-left: 10px; line-height: 18px; font-size: 12px; font-family: Consolas, 'Liberation Mono', Courier, monospace; color: rgb(51, 51, 51);"><pre style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Courier, monospace; margin-top: 0px; margin-bottom: 0px;"></pre></div><div class="line" id="LC55" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC56" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">initFormTemplate</span> <span class="n" style="box-sizing: border-box;">title</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC57" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">liftIO</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">writetField</span> <span class="n" style="box-sizing: border-box;">title</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span></div><div class="line" id="LC58" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">p</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"( delete this line. Press the save button to save the edits)"</span></div><div class="line" id="LC59" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC60" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">[]</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="p" style="box-sizing: border-box;">[</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WType</span><span class="p" style="box-sizing: border-box;">])</span></div><div class="line" id="LC61" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Seq</span> <span class="mi" style="box-sizing: border-box; color: rgb(0, 153, 153);">0</span></div><div class="line" id="LC62" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC62" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC62" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">A form elements return data of type Result. So a form with many elements will return a result of type &nbsp;[Result]</span><br style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><pre style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Courier, monospace; margin-top: 0px; margin-bottom: 0px;"></pre></div><div class="line" id="LC63" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC64" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;">data</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">forall</span> <span class="n" style="box-sizing: border-box;">a</span><span class="o" style="box-sizing: border-box; font-weight: bold;">.</span><span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Typeable</span> <span class="n" style="box-sizing: border-box;">a</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Show</span> <span class="n" style="box-sizing: border-box;">a</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=&gt;</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="n" style="box-sizing: border-box;">a</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">deriving</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Typeable</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC65" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC66" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;">instance</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Show</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">where</span></div><div class="line" id="LC67" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">show</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">)</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">show</span> <span class="n" style="box-sizing: border-box;">x</span></div><div class="line" id="LC68" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC68" style="box-sizing: border-box; padding-left: 10px;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">Each&nbsp;</span><span class="kt" style="color: rgb(68, 85, 136); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; font-weight: bold;">WType</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">&nbsp;data &nbsp;has a&nbsp;</span><span class="nf" style="color: rgb(153, 0, 0); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; font-weight: bold;">genElem</span><font color="#333333" face="Consolas, Liberation Mono, Courier, monospace" size="2"><span style="line-height: 18px;"> </span></font><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">that</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">&nbsp;generates the corresponding form element. That is a formlet/widget that generates the Result. For the &nbsp;</span><a href="http://mflowdemo.herokuapp.com/noscript/basicwidgets/select" title="" target=""><span class="kt" style="color: rgb(68, 85, 136); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; font-weight: bold;">OptionBox</span></a><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">&nbsp;and the&nbsp;</span><span class="kt" style="color: rgb(68, 85, 136); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; font-weight: bold;"><a href="http://mflowdemo.herokuapp.com/noscript/basicwidgets/checkboxes" title="" target="">WCheckBoxes</a>, </span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">press the links to see how to construct them</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">.</span></div><div class="line" id="LC68" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC69" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genElem</span>  <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Intv</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">getInt</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span></div><div class="line" id="LC70" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genElem</span>  <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Stringv</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span>  <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">getString</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span></div><div class="line" id="LC71" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genElem</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">TextArea</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span>  <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">getMultilineText</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">""</span></div><div class="line" id="LC72" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genElem</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span> <span class="n" style="box-sizing: border-box;">xs</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span></div><div class="line" id="LC73" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">getSelect</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">setSelectedOption</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">""</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">p</span>   <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"select a option"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span></div><div class="line" id="LC74" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">firstOf</span><span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">setOption</span> <span class="n" style="box-sizing: border-box;">op</span>  <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">fromStr</span>  <span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="n" style="box-sizing: border-box;">op</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">xs</span><span class="p" style="box-sizing: border-box;">])</span></div><div class="line" id="LC75" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC76" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genElem</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="n" style="box-sizing: border-box;">xs</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span></div><div class="line" id="LC77" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">getCheckBoxes</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">mconcat</span><span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">setCheckBox</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">False</span> <span class="n" style="box-sizing: border-box;">x</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;++</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">fromStr</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="n" style="box-sizing: border-box;">x</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">xs</span><span class="p" style="box-sizing: border-box;">])</span></div><div class="line" id="LC78" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC79" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">genElem</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Form</span> <span class="n" style="box-sizing: border-box;">temp</span> <span class="n" style="box-sizing: border-box;">desc</span><span class="p" style="box-sizing: border-box;">)</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Result</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">generateForm</span> <span class="n" style="box-sizing: border-box;">temp</span> <span class="n" style="box-sizing: border-box;">desc</span></div><div class="line" id="LC80" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC80" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The last definition for a Form with a template and a description is recursive. To generate the complete form with the list of&nbsp;</span><span style="color: rgb(68, 85, 136); font-weight: bold;">WType </span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">elements and the template:</span><br></div><div class="line" id="LC80" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC80" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(153, 0, 0); font-weight: bold;">generateForm :: </span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; white-space: normal;">View Html IO Result</span><br></div><div class="line" id="LC81" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">generateForm</span> <span class="n" style="box-sizing: border-box;">title</span> <span class="n" style="box-sizing: border-box;">xs</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span></div><div class="line" id="LC82" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">input</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">!</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">At</span><span class="o" style="box-sizing: border-box; font-weight: bold;">.</span><span class="n" style="box-sizing: border-box;">type_</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"hidden"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">!</span> <span class="n" style="box-sizing: border-box;">name</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"p0"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">!</span> <span class="n" style="box-sizing: border-box;">value</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"()"</span></div><div class="line" id="LC83" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span>  <span class="n" style="box-sizing: border-box;">template</span> <span class="n" style="box-sizing: border-box;">title</span></div><div class="line" id="LC84" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">pageFlow</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">""</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">allOf</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">map</span> <span class="n" style="box-sizing: border-box;">genElem</span> <span class="n" style="box-sizing: border-box;">xs</span> <span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC85" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The above code is a Widget that uses blaze-html, in the IO monad, that is, it has signature: View Html IO Result. I do not use type signatures too much in order to avoid intimidating non haskellers.</span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The definition uses&nbsp;</span><span class="n" style="box-sizing: border-box;">template</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">, that gets a html template identified by a key,&nbsp;</span>title,<span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;and a widget that process the input, defined by &nbsp;all of the inputs of the elements of the form.&nbsp;</span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="n" style="box-sizing: border-box;"><br></span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="n" style="box-sizing: border-box;">pageFlow</span> <span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">is used to start the form field identifiers from zero on.</span><br></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br>The hidden input field is there to match what&nbsp;</span><span class="n" style="box-sizing: border-box;">allOf</span> <span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">expect to find. The template will contain the form inputs that the genElem's expect, with some addition of text and layout added by the editor with&nbsp;</span>edTemplate<span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;(below)</span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">If we eliminate&nbsp;</span><span class="n" style="box-sizing: border-box;">template</span> <span class="n" style="box-sizing: border-box;">title</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">, what would appear is the form devoid of the editions, but the behaviour would be the same.</span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">And now the hard part. A complex page in MFlow is typically made of applicative combinators, each one contains a monadic expression. The operator &nbsp;</span><span style="font-weight: bold;">&lt;**</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;is like the applicative&nbsp;</span><span style="font-weight: bold;">&lt;*</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;except that the former assures that both sides are executed, while the latter does not execute&nbsp;the second term if the first validates.&nbsp;</span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC87" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">createForm</span>  <span class="n" style="box-sizing: border-box;">title</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> </div><div class="line" id="LC92" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;<span class="n" style="box-sizing: border-box;">divmenu</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="p" style="box-sizing: border-box;">(</span>  <span class="n" style="box-sizing: border-box;">wlogin</span></div><div class="line" id="LC93" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">**&gt; </span><span class="kr" style="font-size: 12px; box-sizing: border-box; font-weight: bold;">do</span><span style="font-size: 12px;"> </span><span class="n" style="font-size: 12px; box-sizing: border-box;">br</span><span style="font-size: 12px;"> </span><span class="o" style="font-size: 12px; box-sizing: border-box; font-weight: bold;">++&gt;</span><span style="font-size: 12px;"> </span><span class="n" style="font-size: 12px; box-sizing: border-box;">wlink</span><span style="font-size: 12px;"> </span><span class="p" style="font-size: 12px; box-sizing: border-box;">(</span><span class="s" style="font-size: 12px; box-sizing: border-box; color: rgb(221, 17, 68);">"save"</span><span style="font-size: 12px;"> </span><span class="ow" style="font-size: 12px; box-sizing: border-box; font-weight: bold;">::</span><span style="font-size: 12px;"> </span><span class="kt" style="font-size: 12px; box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span><span class="p" style="font-size: 12px; box-sizing: border-box;">)</span><span style="font-size: 12px;"> </span><span class="o" style="font-size: 12px; box-sizing: border-box; font-weight: bold;">&lt;&lt;</span><span style="font-size: 12px;"> </span><span class="n" style="font-size: 12px; box-sizing: border-box;">b</span><span style="font-size: 12px;">  </span><span class="s" style="font-size: 12px; box-sizing: border-box; color: rgb(221, 17, 68);">"Save the form and continue"</span></div><div class="line" id="LC95" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;++</span> <span class="n" style="box-sizing: border-box;">br</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&gt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"(when finished)"</span></div><div class="line" id="LC96" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">getSessionData</span> <span class="p" style="box-sizing: border-box;">`</span><span class="n" style="box-sizing: border-box;">onNothing</span><span class="p" style="box-sizing: border-box;">`</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">[]</span></div><div class="line" id="LC97" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;**</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC98" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">wdesc</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">chooseWidget</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;++</span> <span class="n" style="box-sizing: border-box;">hr</span></div><div class="line" id="LC99" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">desc</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getSessionData</span> <span class="p" style="box-sizing: border-box;">`</span><span class="n" style="box-sizing: border-box;">onNothing</span><span class="p" style="box-sizing: border-box;">`</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">[]</span></div><div class="line" id="LC100" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">mappend</span> <span class="n" style="box-sizing: border-box;">desc</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">wdesc</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC101" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">content</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">liftIO</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">readtField</span>  <span class="n" style="box-sizing: border-box;">mempty</span> <span class="n" style="box-sizing: border-box;">title</span></div><div class="line" id="LC102" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">fieldview</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">generateView</span>  <span class="n" style="box-sizing: border-box;">wdesc</span></div><div class="line" id="LC103" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">liftIO</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="n" style="box-sizing: border-box;">writetField</span> <span class="n" style="box-sizing: border-box;">title</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">content</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&gt;</span> <span class="n" style="box-sizing: border-box;">br</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&gt;</span> <span class="n" style="box-sizing: border-box;">fieldview</span></div><div class="line" id="LC104" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC105" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;**</span> <span class="n" style="box-sizing: border-box;">divbody</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span>  <span class="n" style="box-sizing: border-box;">wform</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">edTemplate</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"edituser"</span> <span class="n" style="box-sizing: border-box;">title</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">return</span> <span class="nb" style="box-sizing: border-box; color: rgb(0, 134, 179);">()</span><span class="p" style="box-sizing: border-box;">)</span> <span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC106" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC107" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">divbody</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">div</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">!</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">At</span><span class="o" style="box-sizing: border-box; font-weight: bold;">.</span><span class="n" style="box-sizing: border-box;">style</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"float:right;width:65%"</span></div><div class="line" id="LC108" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">divmenu</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">div</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">!</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">At</span><span class="o" style="box-sizing: border-box; font-weight: bold;">.</span><span class="n" style="box-sizing: border-box;">style</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"background-color:#EEEEEE;float:left;margin-left:10px;margin-right:10px;overflow:auto;"</span></div><div class="line" id="LC109" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC109" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">the operator&nbsp;</span><span style="font-weight: bold;">&lt;&lt;&lt;</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;encloses a widget within a tag. There are two div tags, one for the menu, and other for the rest of the page.</span></div><div class="line" id="LC109" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC109" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">Here are four elements. The direction of the **&gt; &lt;** operators means that only the second will return a valid output, since the other's output is ignored. the elements are:</span></div><div class="line" id="LC109" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><pre style="font-size: 11.818181991577148px; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;"><div class="line" id="LC86" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><ul><li><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The wlogin widget&nbsp;</span><br></li><li><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The save link. Since it is a monadic expression, unless the link is pressed, it will not return a valid output. When pressed, it read the session data generated by the other two widgets and will permit the continuation of the page flow.</span><br></li><li><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The menu of &nbsp;different form elements to choose. When one is clicked which pick an element, add it to the list in the session and add the rendering of the widget to the form. All of this is on the menu on the left</span></li><li><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The form editing in the main part of the window. It uses &nbsp;<span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 18px; white-space: pre; box-sizing: border-box;">edTemplate</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 18px; white-space: pre;"> </span>element that can edit the&nbsp;<span style="color: rgb(221, 17, 68); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 18px; white-space: pre;">"edituser" </span>user. &nbsp;The &nbsp;menu widget above also add form elements when the options are pressed</span></li></ul></div></pre><div class="line" id="LC110" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC110" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;">Here is how the rendering of the widget is obtained when s form element id clicked in the menu and added to the edition . It is critical to name the identifiers of the formlets sequentially from 1 on. the next widget added must be named sequentially. For that matter the sequence is stored and retrieved from the session data.&nbsp;</span><br></div><div class="line" id="LC110" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC110" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;">Then the element is generated (</span><span class="n" style="box-sizing: border-box;">genElem</span> <span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;">), executed (</span><span class="n" style="box-sizing: border-box;">runView</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;">) and the rendering is returned:</span></div><div class="line" id="LC110" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC111" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;">newtype</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Seq</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Seq</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Int</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">deriving</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Typeable</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC112" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC113" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">generateView</span> <span class="n" style="box-sizing: border-box;">desc</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC114" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Seq</span> <span class="n" style="box-sizing: border-box;">n</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getSessionData</span> <span class="p" style="box-sizing: border-box;">`</span><span class="n" style="box-sizing: border-box;">onNothing</span><span class="p" style="box-sizing: border-box;">`</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Seq</span> <span class="mi" style="box-sizing: border-box; color: rgb(0, 153, 153);">0</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC115" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">s</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">get</span></div><div class="line" id="LC116" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">let</span> <span class="n" style="box-sizing: border-box;">n'</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">if</span> <span class="n" style="box-sizing: border-box;">n</span><span class="o" style="box-sizing: border-box; font-weight: bold;">==</span> <span class="mi" style="box-sizing: border-box; color: rgb(0, 153, 153);">0</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">then</span> <span class="mi" style="box-sizing: border-box; color: rgb(0, 153, 153);">1</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">else</span> <span class="n" style="box-sizing: border-box;">n</span></div><div class="line" id="LC117" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">put</span> <span class="n" style="box-sizing: border-box;">s</span><span class="p" style="box-sizing: border-box;">{</span><span class="n" style="box-sizing: border-box;">mfSequence</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">n'</span><span class="p" style="box-sizing: border-box;">}</span></div><div class="line" id="LC118" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="n" style="box-sizing: border-box;">render</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">_</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">runView</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">genElem</span> <span class="n" style="box-sizing: border-box;">desc</span></div><div class="line" id="LC119" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">n''</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">gets</span> <span class="n" style="box-sizing: border-box;">mfSequence</span></div><div class="line" id="LC120" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Seq</span> <span class="n" style="box-sizing: border-box;">n''</span></div><div class="line" id="LC121" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">return</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">[]</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="p" style="box-sizing: border-box;">(</span> <span class="n" style="box-sizing: border-box;">br</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&gt;</span> <span class="n" style="box-sizing: border-box;">br</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&gt;</span> <span class="n" style="box-sizing: border-box;">mconcat</span> <span class="n" style="box-sizing: border-box;">render</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Html</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC122" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC123" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC123" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; line-height: normal; white-space: normal;">Here is the menu, that contains the different widgets that can be added to the edition. &nbsp;The cascade menu works as the main menu of the mflowdemo site (see this&nbsp;</span><i style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal; background-color: rgb(238, 238, 238);"><a class="_noAutoRefresh" href="http://haskell-web.blogspot.com.es/2013/10/a-cascade-menu-coded-in-pure.html" style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal; background-color: rgb(238, 238, 238);">article)</a></i><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">&nbsp;</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">&nbsp;</span><br></div><div class="line" id="LC124" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC125" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">chooseWidget</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span></div><div class="line" id="LC126" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">a</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">!</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">At</span><span class="o" style="box-sizing: border-box; font-weight: bold;">.</span><span class="n" style="box-sizing: border-box;">href</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"/"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"home"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span></div><div class="line" id="LC127" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC128" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">absLink</span> <span class="p" style="box-sizing: border-box;">(</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"text"</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span><span class="p" style="box-sizing: border-box;">)</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"text field"</span></div><div class="line" id="LC129" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">ul</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">li</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="n" style="box-sizing: border-box;">wlink</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Intv</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"returning Int"</span></div><div class="line" id="LC130" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span> <span class="n" style="box-sizing: border-box;">li</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="n" style="box-sizing: border-box;">wlink</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Stringv</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"returning string"</span><span class="p" style="box-sizing: border-box;">))</span></div><div class="line" id="LC131" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC132" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span> <span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">absLink</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">TextArea</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"text area"</span></div><div class="line" id="LC133" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC134" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span> <span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC135" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">absLink</span> <span class="p" style="box-sizing: border-box;">(</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"check"</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span><span class="p" style="box-sizing: border-box;">)</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"checkBoxes"</span></div><div class="line" id="LC136" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">ul</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span>  <span class="n" style="box-sizing: border-box;">getOptions</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"comb"</span></div><div class="line" id="LC137" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC138" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span> <span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC139" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">absLink</span>  <span class="p" style="box-sizing: border-box;">(</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"options"</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">String</span><span class="p" style="box-sizing: border-box;">)</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"options"</span></div><div class="line" id="LC140" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">ul</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;&lt;</span>  <span class="n" style="box-sizing: border-box;">getOptions</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"opt"</span></div><div class="line" id="LC141" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC142" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC143" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">But the two links on the bottom call&nbsp;</span><span class="n" style="box-sizing: border-box;">getOptions</span> <span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">when pressed, and this is a complex widget.&nbsp;</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">As you can see below, it is made of two parts. One has two buttons:&nbsp;</span><span style="color: rgb(221, 17, 68);">"create"</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">, &nbsp;get the session data containing the options chosen.&nbsp;</span><span style="color: rgb(221, 17, 68);">"clear"</span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">&nbsp;reset the options.</span></div><div class="line" id="LC143" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;"><br></span></div><div class="line" id="LC143" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">The second part is a input box and a button that add new options to the session data. Since it is used for both widgets, it is necessary to detect what of both is processing at each moment. If the user change from one to the other option, the set of options is cleared and restarted again.</span></div><div class="line" id="LC144" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC145" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">stop</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">noWidget</span></div><div class="line" id="LC146" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC147" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">getOptions</span> <span class="n" style="box-sizing: border-box;">pf</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span></div><div class="line" id="LC148" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC149" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">r</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">wform</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">submitButton</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"create"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span> <span class="n" style="box-sizing: border-box;">submitButton</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"clear"</span></div><div class="line" id="LC150" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC151" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="n" style="box-sizing: border-box;">r</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC152" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"create"</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC153" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">ops</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getSessionData</span></div><div class="line" id="LC154" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="n" style="box-sizing: border-box;">ops</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC155" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC156" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">elem</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="n" style="box-sizing: border-box;">elem</span></div><div class="line" id="LC157" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"clear"</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC158" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">delSessionData</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">undefined</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WType</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC159" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC160" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC161" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;**</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC162" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">op</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">wform</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">getString</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;!</span> <span class="p" style="box-sizing: border-box;">[(</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"size"</span><span class="p" style="box-sizing: border-box;">,</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"8"</span><span class="p" style="box-sizing: border-box;">)</span></div><div class="line" id="LC163" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">,(</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"placeholder"</span><span class="p" style="box-sizing: border-box;">,</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"option"</span><span class="p" style="box-sizing: border-box;">)]</span></div><div class="line" id="LC164" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;**</span> <span class="n" style="box-sizing: border-box;">submitButton</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"add"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;++</span> <span class="n" style="box-sizing: border-box;">br</span></div><div class="line" id="LC165" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC166" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">mops</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getSessionData</span></div><div class="line" id="LC167" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">ops'</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">mops</span><span class="p" style="box-sizing: border-box;">,</span><span class="n" style="box-sizing: border-box;">pf</span><span class="p" style="box-sizing: border-box;">)</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC168" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span><span class="p" style="box-sizing: border-box;">,</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"comb"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span> <span class="p" style="box-sizing: border-box;">;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC169" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span><span class="p" style="box-sizing: border-box;">,</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"opt"</span><span class="p" style="box-sizing: border-box;">)</span>  <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span> <span class="p" style="box-sizing: border-box;">;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC170" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">_</span><span class="p" style="box-sizing: border-box;">),</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"comb"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span> <span class="p" style="box-sizing: border-box;">;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC171" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">_</span><span class="p" style="box-sizing: border-box;">),</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"opt"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span> <span class="p" style="box-sizing: border-box;">;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC172" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="n" style="box-sizing: border-box;">ops</span><span class="p" style="box-sizing: border-box;">),</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"comb"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC173" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">let</span> <span class="n" style="box-sizing: border-box;">ops'</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">nub</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">op</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">:</span><span class="n" style="box-sizing: border-box;">ops</span></div><div class="line" id="LC174" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">WCheckBoxes</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">ops'</span></div><div class="line" id="LC175" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">return</span> <span class="n" style="box-sizing: border-box;">ops'</span></div><div class="line" id="LC176" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span> <span class="n" style="box-sizing: border-box;">ops</span><span class="p" style="box-sizing: border-box;">),</span><span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"opt"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span>  <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC177" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">let</span> <span class="n" style="box-sizing: border-box;">ops'</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">nub</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">op</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">:</span><span class="n" style="box-sizing: border-box;">ops</span></div><div class="line" id="LC178" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">setSessionData</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">OptionBox</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">ops'</span></div><div class="line" id="LC179" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">return</span> <span class="n" style="box-sizing: border-box;">ops'</span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">wraw</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">mconcat</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">p</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="n" style="box-sizing: border-box;">op</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">|</span> <span class="n" style="box-sizing: border-box;">op</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">ops'</span><span class="p" style="box-sizing: border-box;">]</span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><br></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><br></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">Finally the last line at the bottom display the options entered so far.</span><br></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;"><br></span></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;">stop<span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">&nbsp;is defined as an invalid widget (noWidget) that stops the monadic sequence, and, like in the former case, the only element that can return a valid output is the&nbsp;</span><span style="color: rgb(221, 17, 68);">"create" </span><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">button, that return the result to the menu and trigger the addition of the widget to the&nbsp;</span>edTemplate<span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">. widget.</span></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;"><br></span></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;">And voila, a form editor. The next page uses generateForm &nbsp;to re-generate the form from the description and the formatting to get input. As I said above, the form has no validation messages, since the layout mask the validation messages. To have &nbsp;"holes" in the template, we need<a href="/noscript/wiki/singlepage.html" title="" target=""> witerate and dField</a> modifiers. But that will be done in the next example. Stay tuned</span></span></div><div class="line" id="LC180" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;"><span style="font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 12.727272033691406px; white-space: normal;"><br></span></span></div></pre>