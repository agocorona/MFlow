<br>Now it is possible to create Web Services. &nbsp;These three examples below show three ways to create them. The third one uses the Widget monad and process the parameters as if they were a parsec-like parser. &nbsp;The result is a more compact code.&nbsp;<br><br>The three services implement a sum and a product of two integers.&nbsp;<br><br>First, a REST web service, where the parameters are in a REST path&nbsp;<br><pre style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 18px; font-size: 12px; font-family: Consolas, 'Liberation Mono', Courier, monospace; color: rgb(51, 51, 51);"><div class="line" id="LC8" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC13" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">main</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">runNavigation</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"apirest"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="n" style="box-sizing: border-box;">step</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">ask</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC14" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">op</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getRestParam</span></div><div class="line" id="LC15" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">term1</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getRestParam</span></div><div class="line" id="LC16" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">term2</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getRestParam</span></div><div class="line" id="LC17" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">term1</span><span class="p" style="box-sizing: border-box;">,</span><span class="n" style="box-sizing: border-box;">term2</span><span class="p" style="box-sizing: border-box;">)</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC18" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"sum"</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span>  <span class="n" style="box-sizing: border-box;">wrender</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">+</span> <span class="n" style="box-sizing: border-box;">y</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Int</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">**&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC19" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"prod"</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span>  <span class="n" style="box-sizing: border-box;">wrender</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">*</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">**&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC20" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">_</span>  <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span><span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="c1" style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;">-- blaze Html</span></div><div class="line" id="LC21" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h1</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"ERROR. API usage:"</span></div><div class="line" id="LC22" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"http://server/api/sum/[Int]/[Int]"</span></div><div class="line" id="LC23" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"http://server/api/prod/[Int]/[Int]"</span></div><div class="line" id="LC24" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">stop = noWidget &nbsp;does not validate, so ask willl not navigate forward.</span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">Some example of invocation:</span><br style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><b><i><a href="http://mflowdemo.herokuapp.com/apirest/prod/4/3" title="" target=""><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">http://mflowdemo.herokuapp.com/apirest/prod/4/3</span><br style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"></a><br style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"></i></b><a href="http://mflowdemo.herokuapp.com/apirest/sum/5/7" title="" target=""><b><i><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">http://mflowdemo.herokuapp.com/</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">apirest</span><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">/sum/5/7</span></i></b><br></a></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><br></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">The second example read key-value parameters for the numbers instead of REST parameters:</span></div><div class="line" id="LC26" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC27" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">main</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">runNavigation</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"apikw"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="n" style="box-sizing: border-box;">step</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">ask</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC28" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">op</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getRestParam</span></div><div class="line" id="LC29" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">term1</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getKeyValueParam</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"t1"</span></div><div class="line" id="LC30" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">term2</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getKeyValueParam</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"t2"</span></div><div class="line" id="LC31" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">op</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">term1</span><span class="p" style="box-sizing: border-box;">,</span><span class="n" style="box-sizing: border-box;">term2</span><span class="p" style="box-sizing: border-box;">)</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC32" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span>  <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"sum"</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span>  <span class="n" style="box-sizing: border-box;">wrender</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">+</span> <span class="n" style="box-sizing: border-box;">y</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Int</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">**&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC33" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"prod"</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span>  <span class="n" style="box-sizing: border-box;">wrender</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">*</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">**&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC34" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">_</span>  <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span><span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="c1" style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;">-- blaze Html</span></div><div class="line" id="LC35" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h1</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"ERROR. API usage:"</span></div><div class="line" id="LC36" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"http://server/api/sum?t1=[Int]&amp;t2=[Int]"</span></div><div class="line" id="LC37" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"http://server/api/prod?t1=[Int]&amp;t2=[Int]"</span></div><div class="line" id="LC38" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><pre style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; font-family: Consolas, 'Liberation Mono', Courier, monospace;"><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">Some example invocation:</span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><br></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><b><i><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">http://mflowdemo.herokuapp.com</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">/apikv/prod?t1=4&amp;t2=3</span></i></b></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><b><i><br></i></b></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><a href="http://mflowdemo.herokuapp.com/apikv/sum?t1=4&amp;t2=3" title="" target=""><b><i><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">http://mflowdemo.herokuapp.com</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">/apikv/sum?t1=4&amp;t2=3</span></i></b></a></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><pre style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; font-family: Consolas, 'Liberation Mono', Courier, monospace;"></pre></div></pre></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The third service uses key-value parameters as well, but I defined parsec-like combinators that are Widgets as well. That is right, since a widget is both a parser element and a writer.&nbsp;</span></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The combinators&nbsp;</span><span class="n" style="box-sizing: border-box;">rest</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;and&nbsp;</span><span class="n" style="box-sizing: border-box;">wint</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">&nbsp;are &nbsp;defined below, from&nbsp;</span>getRestParam and <span class="n" style="box-sizing: border-box;">getKeyValueParam. </span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13.333333969116211px; line-height: normal; white-space: normal;">They are now part of the MFlow.Forms.WebApi module</span></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><span class="n" style="box-sizing: border-box;"><br></span></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><i style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">rest </i><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">verify that the next rest parameter is the value expected. </span><i style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">wint </i><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">read a parameter of type Int with a given key. &lt;?&gt; present a blaze-html formatting when the parser fails, like in a parser combinator. It uses the same applicative, alternative and monadic combinators defined for any other widget in MFlow:</span><br></div><div class="line" id="LC39" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC40" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">main</span>  <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">runNavigation</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"apiparser"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="n" style="box-sizing: border-box;">step</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">.</span> <span class="n" style="box-sizing: border-box;">asks</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span></div><div class="line" id="LC41" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">rest</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"sum"</span>  <span class="p" style="box-sizing: border-box;">;</span> <span class="n" style="box-sizing: border-box;">disp</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="p" style="box-sizing: border-box;">(</span><span class="o" style="box-sizing: border-box; font-weight: bold;">+</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">wint</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"t1"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;*&gt;</span> <span class="n" style="box-sizing: border-box;">wint</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"t2"</span></div><div class="line" id="LC42" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;|&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="n" style="box-sizing: border-box;">rest</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"prod"</span> <span class="p" style="box-sizing: border-box;">;</span> <span class="n" style="box-sizing: border-box;">disp</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="p" style="box-sizing: border-box;">(</span><span class="o" style="box-sizing: border-box; font-weight: bold;">*</span><span class="p" style="box-sizing: border-box;">)</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;$&gt;</span> <span class="n" style="box-sizing: border-box;">wint</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"t1"</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;*&gt;</span> <span class="n" style="box-sizing: border-box;">wint</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"t2"</span></div><div class="line" id="LC43" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;?&gt;</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span> <span class="c1" style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;">-- blaze Html</span></div><div class="line" id="LC44" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h1</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"ERROR. API usage:"</span></div><div class="line" id="LC45" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"http://server/api/sum?t1=[Int]&amp;t2=[Int]"</span></div><div class="line" id="LC46" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">h3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;&lt;</span> <span class="s" style="box-sizing: border-box; color: rgb(221, 17, 68);">"http://server/api/prod?t1=[Int]&amp;t2=[Int]"</span></div><div class="line" id="LC47" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">where</span></div><div class="line" id="LC48" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">asks</span> <span class="n" style="box-sizing: border-box;">w</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">ask</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">w</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC49" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC49" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC49" style="box-sizing: border-box; padding-left: 10px;"><pre style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; font-family: Consolas, 'Liberation Mono', Courier, monospace;"><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;">Some example invocation:</span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-size: 13px; line-height: normal; white-space: normal; font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif;"><br></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><a href="http://mflowdemo.herokuapp.com/apiparser/prod?t1=4&amp;t2=3" title="" target=""><b><i><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">http://mflowdemo.herokuapp.com</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">/apiparser/prod?t1=4&amp;t2=3</span></i></b></a></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><b><i><br></i></b></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><a href="http://mflowdemo.herokuapp.com/apiparser/sum?t1=4&amp;t2=3" title="" target=""><b><i><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">http://mflowdemo.herokuapp.com</span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">/apiparser/sum?t1=4&amp;t2=3</span></i></b></a></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">I will incorporate some example with JSON output in the next Web service example&nbsp;</span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;">The parser methods are defined here,</span><span class="n" style="font-size: 12px; box-sizing: border-box;"> </span><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13.333333969116211px; line-height: normal; white-space: normal;">They are now part of the MFlow.Forms.WebApi module</span></div><div class="line" id="LC25" style="box-sizing: border-box; padding-left: 10px;"><span style="color: rgb(0, 0, 0); font-family: 'rebuchet MS', Helvetica, Arial, Verdana, sans-serif; font-size: 13px; line-height: normal; white-space: normal;"><br></span></div></pre></div><div class="line" id="LC50" style="box-sizing: border-box; padding-left: 10px;"><span class="c1" style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;">-- To be added to MFlow.Forms.WebApi.hs   --</span></div><div class="line" id="LC51" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC52" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">stop</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">noWidget</span></div><div class="line" id="LC53" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC54" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">wrestParam</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC55" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">mr</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getRestParam</span></div><div class="line" id="LC56" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">return</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">[]</span> <span class="n" style="box-sizing: border-box;">mr</span></div><div class="line" id="LC57" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC58" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">rest</span> <span class="n" style="box-sizing: border-box;">v</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC59" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">r</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">wrestParam</span></div><div class="line" id="LC60" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">if</span> <span class="n" style="box-sizing: border-box;">r</span><span class="o" style="box-sizing: border-box; font-weight: bold;">==</span><span class="n" style="box-sizing: border-box;">v</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">then</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="n" style="box-sizing: border-box;">v</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">else</span> <span class="n" style="box-sizing: border-box;">modify</span> <span class="p" style="box-sizing: border-box;">(</span><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">\</span><span class="n" style="box-sizing: border-box;">s</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">s</span><span class="p" style="box-sizing: border-box;">{</span><span class="n" style="box-sizing: border-box;">mfPIndex</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">mfPIndex</span> <span class="n" style="box-sizing: border-box;">s</span><span class="o" style="box-sizing: border-box; font-weight: bold;">-</span><span class="mi" style="box-sizing: border-box; color: rgb(0, 153, 153);">1</span><span class="p" style="box-sizing: border-box;">})</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC61" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC62" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">wparam</span> <span class="n" style="box-sizing: border-box;">par</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC63" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">mr</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">getKeyValueParam</span> <span class="n" style="box-sizing: border-box;">par</span></div><div class="line" id="LC64" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">return</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">[]</span> <span class="n" style="box-sizing: border-box;">mr</span></div><div class="line" id="LC65" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC66" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">disp</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Show</span> <span class="n" style="box-sizing: border-box;">a</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">=&gt;</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Html</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">IO</span> <span class="n" style="box-sizing: border-box;">a</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Html</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">IO</span> <span class="nb" style="box-sizing: border-box; color: rgb(0, 134, 179);">()</span></div><div class="line" id="LC67" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">disp</span> <span class="n" style="box-sizing: border-box;">w</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC68" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">elm</span><span class="o" style="box-sizing: border-box; font-weight: bold;">@</span><span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="n" style="box-sizing: border-box;">f</span> <span class="n" style="box-sizing: border-box;">mx</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">runView</span> <span class="n" style="box-sizing: border-box;">w</span></div><div class="line" id="LC69" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="n" style="box-sizing: border-box;">mx</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC70" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="n" style="box-sizing: border-box;">f</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span></div><div class="line" id="LC71" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">justx</span><span class="o" style="box-sizing: border-box; font-weight: bold;">@</span><span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">f</span><span class="o" style="box-sizing: border-box; font-weight: bold;">++</span><span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">fromStr</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">show</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">])</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="nb" style="box-sizing: border-box; color: rgb(0, 134, 179);">()</span></div><div class="line" id="LC72" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC73" style="box-sizing: border-box; padding-left: 10px;"><br></div><div class="line" id="LC76" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC77" style="box-sizing: border-box; padding-left: 10px;"><span class="kr" style="box-sizing: border-box; font-weight: bold;">infixl</span> <span class="mi" style="box-sizing: border-box; color: rgb(0, 153, 153);">3</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;?&gt;</span></div><div class="line" id="LC78" style="box-sizing: border-box; padding-left: 10px;"><span class="p" style="box-sizing: border-box;">(</span><span class="o" style="box-sizing: border-box; font-weight: bold;">&lt;?&gt;</span><span class="p" style="box-sizing: border-box;">)</span> <span class="n" style="box-sizing: border-box;">w</span> <span class="n" style="box-sizing: border-box;">v</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">do</span></div><div class="line" id="LC79" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="n" style="box-sizing: border-box;">r</span><span class="o" style="box-sizing: border-box; font-weight: bold;">@</span><span class="p" style="box-sizing: border-box;">(</span><span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">FormElm</span> <span class="n" style="box-sizing: border-box;">f</span> <span class="n" style="box-sizing: border-box;">mx</span><span class="p" style="box-sizing: border-box;">)</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">&lt;-</span> <span class="n" style="box-sizing: border-box;">runView</span> <span class="n" style="box-sizing: border-box;">w</span></div><div class="line" id="LC80" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;<span class="kr" style="box-sizing: border-box; font-weight: bold;">case</span> <span class="n" style="box-sizing: border-box;">mx</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">of</span></div><div class="line" id="LC81" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Nothing</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">runView</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">$</span> <span class="n" style="box-sizing: border-box;">v</span> <span class="o" style="box-sizing: border-box; font-weight: bold;">++&gt;</span> <span class="n" style="box-sizing: border-box;">stop</span></div><div class="line" id="LC82" style="box-sizing: border-box; padding-left: 10px;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Just</span> <span class="kr" style="box-sizing: border-box; font-weight: bold;">_</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">-&gt;</span> <span class="n" style="box-sizing: border-box;">return</span> <span class="n" style="box-sizing: border-box;">r</span></div><div class="line" id="LC83" style="box-sizing: border-box; padding-left: 10px;"><br style="box-sizing: border-box;"></div><div class="line" id="LC84" style="box-sizing: border-box; padding-left: 10px;"><span class="nf" style="box-sizing: border-box; color: rgb(153, 0, 0); font-weight: bold;">wint</span> <span class="n" style="box-sizing: border-box;">p</span><span class="ow" style="box-sizing: border-box; font-weight: bold;">=</span> <span class="n" style="box-sizing: border-box;">wparam</span> <span class="n" style="box-sizing: border-box;">p</span> <span class="ow" style="box-sizing: border-box; font-weight: bold;">::</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">View</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Html</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">IO</span> <span class="kt" style="box-sizing: border-box; color: rgb(68, 85, 136); font-weight: bold;">Int</span></div></pre>