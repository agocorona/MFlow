<h1>New push mode, to present data in real time: Basic chat example</h1><div class="\&quot;post-header\&quot;" style="\&quot;line-height:" 1.6;="" margin:="" 0px="" 1.5em;="" font-size:="" 11px;="" color:="" rgb(34,="" 34,="" 34);="" font-family:="" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;="" background-color:="" rgb(255,="" 255,="" 255);\"=""><div class="\&quot;post-header-line-1\&quot;"></div></div><div class="\&quot;post-body" entry-content\"="" id="\&quot;post-body-3358894824256003953\&quot;" itemprop="\&quot;description" articlebody\"="" style="\&quot;width:" 730px;="" position:="" relative;="" background-color:="" rgb(255,="" 255,="" 255);\"=""><div style="\&quot;color:" rgb(34,="" 34,="" 34);="" font-family:="" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;="" font-size:="" 13px;="" line-height:="" 1.4;="" text-align:="" justify;\"=""><span style="\&quot;line-height:" 1.4;\"="">The new asynchronous widgets can display server information at the moment that they appear. And thanks to Software Transactional Memory (or MVars) this may be immediately.</span></div><div style="\&quot;text-align:" justify;\"=""><font color="\&quot;#222222\&quot;" face="\&quot;Arial," tahoma,="" helvetica,="" freesans,="" sans-serif\"="" size="\&quot;2\&quot;"><span style="\&quot;line-height:" 18px;\"=""><br></span></font></div><font color="\&quot;#222222\&quot;" face="\&quot;Arial," tahoma,="" helvetica,="" freesans,="" sans-serif\"="" size="\&quot;2\&quot;"><div style="\&quot;text-align:" justify;\"=""><span style="\&quot;line-height:" 1.4;\"="">The new primitive, push, like autoRefresh,&nbsp; is a modifier of a widget behavior. In this case push&nbsp; will execute the widget and present the output again and again using ajax internally.&nbsp;</span></div><div style="\&quot;text-align:" justify;\"=""><span style="\&quot;line-height:" 1.4;\"=""><br></span></div><div style="\&quot;text-align:" justify;\"=""><span style="\&quot;line-height:" 1.4;\"="">This is an example of a basic chat. All users inputs go to a mutable variable. this mutable variable (TVar) is watched by each user push widget, that wait for a new input, and simultaneously refresh all the user windows with every new message. As is now, the message must be different than the previous to be updated. (see the documentation about STM variables work)</span></div><div style="\&quot;text-align:" justify;\"=""><span style="\&quot;line-height:" 1.4;\"=""><br></span></div><div style="\&quot;text-align:" justify;\"=""><span style="\&quot;line-height:" 1.4;\"="">Since there is a single push widget spawned per session and all browser tabs share the session, the chat will not work among two windows of the same browser, because the messages will appear alternatively in one and the other browser tab. but you can test it with two different browsers, for example, explorer and chrome. The single push widget per session is a design limitation in order to prevent the spawn of excessive server processes.</span></div><div style="\&quot;text-align:" justify;\"=""><div><span style="\&quot;line-height:" 18px;\"=""><br></span></div><div><span style="\&quot;line-height:" 18px;\"="">The content of the text box will be appended to the push widget above it</span></div><div><span style="\&quot;line-height:" 18px;\"=""><br></span></div><div><span style="\&quot;line-height:" 18px;\"="">&nbsp;Note that the push process do not push just data but a widget content. A push widget can have links and form fields that may &nbsp;interact back with the server creating a page flow. This functionality is not evident in this example, hbiwever since the rendering of the widget is</span></div><div><span style="\&quot;line-height:" 18px;\"=""><br></span></div><div><pre style="\&quot;color:" rgb(0,="" 0,="" 0);="" text-align:="" start;\"=""><span style="\&quot;font-family:" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;\"="">p </span><font color="\&quot;Cyan\&quot;" style="\&quot;font-family:" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;\"="">&lt;&lt;</font><span style="\&quot;font-family:" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;\"="">  line </span><font color="\&quot;Cyan\&quot;" style="\&quot;font-family:" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;\"="">++&gt;</font><span style="\&quot;font-family:" arial,="" tahoma,="" helvetica,="" freesans,="" sans-serif;\"=""> noWidget</span><br></pre></div><div><br></div><div>that is, a paragraph with the last input line and a dumb (invisible) widget that perform no action.</div><div><br></div><div><span style="\&quot;line-height:" 18px;\"="">Since push widgets are asynchronous, the communication must be trough mutable variables with the rest of the widgets of the page.</span></div><div><span style="\&quot;line-height:" 18px;\"=""><br></span></div><div><span style="\&quot;line-height:" 18px;\"="">Note also that the input box is configured with autoRefresh in order to prevent navigation or the refresh of the page with every form input.</span></div></div></font></div>